var navman_dirty=!1,navman_delete=[],navman_edits={},navman_editing=null;if("undefined"===typeof bu||"undefined"===typeof bu.navigation||"undefined"===typeof bu.navigation.tree)throw new TypeError("BU Navigation Manager script dependencies have not been met!");
jQuery(document).ready(function(a){function d(b){"link"==b.type?(a("#editlink_id").attr("value",b.ID),a("#editlink_address").attr("value",b.content),a("#editlink_label").attr("value",b.title),"new"==b.meta.bu_link_target?a("#editlink_target_new").attr("checked","checked"):a("#editlink_target_same").attr("checked","checked"),navman_editing=b,a("#navman_editlink").dialog("open")):window.location="post.php?action=edit&post="+b.ID}bu.navigation.views=bu.navigation.views||{};var c;a("div.inner-sidebar").show();
a("input[name='bu_navman_delete']").attr("disabled","disabled");a("input[name='bu_navman_edit']").attr("disabled","disabled");c=bu.navigation.tree("navman",{el:"#navman_container"});c.listenFor("selectPost",function(){a("input[name='bu_navman_delete']").removeAttr("disabled");a("input[name='bu_navman_edit']").removeAttr("disabled")});c.listenFor("deselectPost",function(){a("input[name='bu_navman_delete']").attr("disabled","disabled");a("input[name='bu_navman_edit']").attr("disabled","disabled")});
c.listenFor("editPost",function(a){d(a)});c.listenFor("removePost",function(a){if(a=a.ID)navman_delete.push(a),navman_dirty=!0});a('input[name="bu_navman_edit"]').click(function(){var a=c.getSelected();d(a)});a('input[name="bu_navman_delete"]').click(function(){var a=c.getSelected();c.removePost(a)});a("#navman_expand_all, #navman_expand_all_b").click(function(a){a.preventDefault();a.stopImmediatePropagation();c.showAll()});a("#navman_collapse_all, #navman_collapse_all_b").click(function(a){a.preventDefault();
a.stopImmediatePropagation();c.hideAll()});a("#bu_navman_save, #bu_navman_save_b").click(function(){navman_dirty=!1});a("#navman_form").submit(function(){var b=c.getPosts();a("#navman_data").attr("value",JSON.stringify(b));a("#navman_delete").attr("value",JSON.stringify(navman_delete));a("#navman_edits").attr("value",JSON.stringify(navman_edits))});a("#navman_editlink").dialog({autoOpen:!1,buttons:{Ok:function(){if(a("#navman_editlink_form").valid()){var b=navman_editing;b.content=a("#editlink_address").attr("value");
b.title=a("#editlink_label").attr("value");b.meta.bu_link_target=a("input[name='editlink_target']:checked").attr("value");"new"!==b.status&&(navman_edits[b.ID]=b);c.updatePost(b);a("#navman_editlink").dialog("close");a("#editlink_id").attr("value","");a("#editlink_address").attr("value","");a("#editlink_label").attr("value","");a("#editlink_target_same").attr("checked","");navman_dirty=!0;navman_editing=null}},Cancel:function(){a("#navman_editlink").dialog("close");a("#editlink_id").attr("value",
"");a("#editlink_address").attr("value","");a("#editlink_label").attr("value","");a("#editlink_target_same").attr("checked","");navman_editing=null}},minWidth:400,width:500,modal:!0,resizable:!1});a("#addlink_add").click(function(){if(a("#navman_addlink_form").valid()){var b=a("#addlink_address").attr("value").replace(/^\s+|\s+$/g,""),d=a("#addlink_label").attr("value").replace(/^\s+|\s+$/g,""),e=a("input[name='addlink_target']:checked").attr("value");a("#addlink_address").attr("value","");a("#addlink_label").attr("value",
"");c.insertPost({status:"new",type:"link",content:b,title:d,meta:{bu_link_target:e}});navman_dirty=!0}})});window.onbeforeunload=function(){if(navman_dirty)return"You have made changes to your navigation that have not yet been saved."};